# 1. Introduction

全球生物多样性正持续衰退，其中淡水生态系统受影响尤为严重。淡水生态系统虽然仅占地球表面积的极小比例，却支撑着不成比例高的物种多样性和关键生态系统服务，包括为约三分之一的脊椎动物和近一半的鱼类提供栖息地，并通过养分循环、洪水调节和气候调节等过程维持数十亿人的福祉[Ref1–Ref3]。在气候变暖、水文节律改变和土地利用集约化的共同作用下，河流鱼类种群正经历范围收缩、局地灭绝和群落重组，预测其在大陆尺度上的分布动态已成为淡水保护与气候适应规划中的核心问题[Ref4–Ref6]。

物种分布模型（species distribution models, SDMs）已被广泛用于量化栖息地适宜性、识别气候避难所和评估未来情景下的潜在分布变化，涵盖从淡水鱼类到底栖无脊椎动物的多类群[Ref7–Ref9]。然而，多数 SDMs 延续了陆地生物地理的建模范式：环境因子通常源于规则气候格网，被视为局地栅格属性；河流网络的连通性和上游累积过程往往被简化为流域因子或直接忽略[Ref10–Ref12]。对于受流向和汇水区过程强烈制约的淡水鱼类而言，这种表征导致实际环境暴露与模型输入之间出现系统性错配，削弱了模型对水文网络过程的响应能力。

网络加权的水文气候和环境数据为突破这一局限提供了新的契机。近年来发展的河流特异性数据集（例如基于 EarthEnv-Streams 的 1 km 分辨率河流产品）在汇水区尺度上对温度、降水、土地覆盖和土壤性质进行上游面积加权，从而显式编码了上游–下游连通性和汇水区整合过程[Ref13–Ref15]。这类数据使得在大陆尺度上构建“河网一致”的 SDMs 成为可能，即模型中的环境变量与水生生物实际感知的累积暴露更为吻合。然而，目前只有少数研究在淡水系统中系统使用网络加权变量，多数工作仍依赖叠加在河流线上的陆地气候格网，限制了对流域过程的刻画[Ref16]。

另一方面，主流 SDMs 仍然以相关范式为基础。随机森林、梯度提升、神经网络等算法能够捕捉复杂的非线性模式，其变量重要性指标和响应曲线有助于识别“重要”环境梯度，但这些指标本质上反映的是预测贡献而非因果效应[Ref17–Ref19]。在存在未观测协变量和复杂变量间依赖结构的情况下，高重要性变量可能只是位于真实驱动因素下游的“代理”，而非直接管理杠杆。这种相关性解释在设计干预措施（如流域土地利用调控、河岸恢复或水温管理）时可能产生误导，因为改变这些变量不一定会以预期方式改变物种分布[Ref20]。近年来，基于贝叶斯网络的因果发现、双重机器学习（double machine learning）和因果森林（causal forests）等方法为在高维观测环境下识别因果结构和估计平均与条件处理效应提供了新工具[Ref21–Ref24]，但其在河流 SDM 框架中的应用仍然有限。

未来情景预测中的不确定性是另一个关键但常被低估的问题。淡水 SDMs 的预测不确定性来自多个层面，包括模型结构差异（不同算法对物种–环境关系的假设不同）、情景差异（不同温室气体排放路径和社会经济轨迹下的气候投影差异）以及气候模式本身的不确定性[Ref25–Ref27]。现有研究往往强调不同排放情景之间的差异，却较少定量比较结构不确定性与情景不确定性的相对重要性，更缺乏在河流网络上进行空间显式分解的工作，从而难以判断保护实践应优先通过多模型集成缓解结构不确定，还是通过拓展情景族群来刻画气候不确定[Ref28, Ref29]。

综上，从淡水物种分布建模的角度看，当前框架在三方面仍存在关键空白：其一，环境表征多基于陆地气候格网，难以反映河流网络中的上游累积与连通过程；其二，变量重要性与响应曲线主要停留在相关层面，缺乏因果结构与处理效应的定量刻画；其三，未来预测中的结构与情景不确定性尚未在河流网络上得到系统分解与比较。

在上述背景下，本研究以中国大陆全河流网络为研究对象，选择广布淡水鱼类中华鲫（*Carassius auratus*）作为示范物种，围绕这三类缺口构建了一个集河网一致环境表征、因果推断与不确定性分解于一体的物种分布建模框架。具体而言，（i）在网络加权的水文气候、地形、土地覆盖和土壤图层基础上构建 1 km 河网像元的环境暴露，并通过系统的多重共线性控制获得简约而生态上完整的预测因子集合；（ii）在多算法 SDM 的基础上结合因果结构学习、双重机器学习和因果森林，分离关键驱动因子的平均与空间异质性因果效应，从而将“预测性强的变量”转化为“具备管理意义的因果杠杆”；（iii）在仅使用情景一致变量再训练模型的前提下，对 CMIP6 中世纪气候情景下的适宜性进行多模型、多情景投影，并在河流网络上分解结构与情景不确定性，量化算法选择与排放路径对预测方差的相对贡献。本研究旨在为大陆尺度淡水 SDM 提供一个河网一致且因果信息丰富的建模范式，为在快速环境变化下识别高价值河段和优先干预区域提供定量依据。

[Figure 1 placeholder: Continental river network of China and occurrences of *Carassius auratus*.]


# 2. Materials and Methods

## 2.1 研究区域与物种数据

研究区域被界定为覆盖中国大陆全部河流网络的大陆尺度空间域（约 73.95°E–134.45°E, 18.25°N–53.34°N），包括从青藏高原至东部沿海的完整高程梯度，以及从南部季风湿润区到北部温带干旱区的多种气候带[Ref30]。河流网络基于 EarthEnv-Streams 等全球水文产品构建，经投影至等面积阿尔伯斯锥形投影，以确保在大范围内进行面积与距离计算时的几何精度[Ref13]。通过设置流量累积阈值（≥100 栅格单元，对应约 100 km² 汇水面积）划定永久性河段，得到约 210 万个 1 km 河网像元作为潜在水生栖息地。

中华鲫存在记录来自三类主要来源：同行评审文献中的历史调查、FishBase 等专业数据库以及 GBIF 等全球生物多样性信息平台[Ref31–Ref33]。原始记录首先经过坐标完整性与范围检查，剔除了缺失或不合理坐标点；随后利用高分辨率国界矢量数据裁剪至中国境内。通过识别完全重复坐标点剔除重复记录，并在 ~10 km（0.09°）网格上实施空间稀疏化，在每个网格单元中仅保留一个存在点，以降低空间自相关与采样偏差。经此处理后，获得 517 个空间独立的存在记录。结合环境变量提取结果并控制缺失值后，最终用于建模的数据集包含 336 个存在记录。

## 2.2 环境变量与预处理

为表征河流网络中多尺度、多过程环境梯度，从四个主题域汇集了候选环境变量[Ref13–Ref15]：（i）河网拓扑与连通性，例如流量累积、流径长度和河流等级，用于刻画层级位置、上游汇水规模以及暴露于上游扰动的程度；（ii）上游面积加权的水文气候变量，包括逐月及季节尺度的温度和降水，用于表征经网络加权后的热量与水分制度；（iii）基于地形数据派生的高程与坡度统计量及地形形态指标，用于反映能量梯度和地貌复杂性；（iv）上游面积加权的土地覆盖和土壤性质，包括不同土地覆盖类型比例以及 pH、有机碳和质地等土壤属性，用于刻画汇水区尺度的土地利用与土壤控制。所有变量均重采样到 1 km 分辨率，并限制在河网像元上。

从超过 100 个候选预测因子出发，采用三步预筛选流程控制多重共线性并保留生态上有意义的梯度[Ref34, Ref35]。首先剔除方差为零或近零的变量。随后通过皮尔逊相关系数矩阵筛除绝对相关系数 |r|>0.8 的变量对，优先保留生态解释性更强、缺失率更低的变量。最后利用方差膨胀因子（variance inflation factor, VIF）实施迭代剔除，直至所有保留变量的 VIF≤10。预筛选后的变量在样本点上进行 z 分数标准化，以便不同量纲之间比较效应大小，并提高部分算法的数值稳定性。最终得到 47 个相对独立的预测因子，按地形与河网、网络加权水文气候、土地覆盖和土壤性质四组进行组织，用于后续建模与因果分析。

## 2.3 背景点与数据划分

在存在记录基础上，为构建 presence–background 模型，在河网掩膜内生成背景点。通过在永久性河段像元上实施泊松圆盘采样，设置最小点间距约 5 km，并避免与存在点所在像元重叠，从而获得空间上均匀且避免聚集的背景样本。背景点与存在点的比例约为 5:1，经与环境变量栅格叠加后，得到 1680 个背景点与 336 个存在点，共 2016 个样本用于模型训练与评价。

为实现模型性能的独立评估，采用分层抽样将数据集划分为 80% 训练集和 20% 测试集，分层依据为存在/背景类别，以保持两类样本在不同子集中的比例一致。训练集中保留约 1613 个样本（包含 269 个存在点），测试集包含 403 个样本（其中 67 个存在点）。数据划分过程通过设置随机种子确保可重复性。

## 2.4 模型算法与评估指标

为捕捉不同形式的物种–环境关系，选择了四种互补的 SDM 算法：最大熵模型（Maxent，在本研究中通过 `maxnet` 实现）、随机森林（random forest, RF）、广义可加模型（generalized additive model, GAM）以及单隐层神经网络（neural network, NN）。Maxent 通过正则化逻辑回归在多种特征函数空间中拟合存在–背景数据，适于处理复杂非线性关系和偏斜分布[Ref7, Ref36]；随机森林通过多棵 bootstrap 决策树集成捕捉非线性和高阶交互；GAM 在广义线性模型基础上引入平滑函数，以较高解释性建模非线性响应；神经网络则通过隐含层权重组合刻画复杂决策边界。

所有模型均在训练集上拟合，在独立测试集上评估预测性能。采用多种互补指标包括 ROC 曲线下面积（area under the curve, AUC）、真技巧统计量（true skill statistic, TSS）、灵敏度（sensitivity）和特异度（specificity）[Ref8, Ref37]。AUC 表征阈值无关的区分能力；TSS 在通过 Youden 指数选择的最优阈值下综合平衡灵敏度与特异度；同时计算 Boyce 指数以评估概率输出的校准度[Ref38]。阈值选择采用最大化 TSS 的原则，以便与保护实践中二元适宜性划分相衔接。

[Table 1 placeholder: Summary of model algorithms, key hyperparameters and evaluation metrics on the test set.]

## 2.5 因果结构学习与效应估计

为从相关关联推进至因果推断，在环境预测因子空间上实施因果结构学习与因果效应估计。首先，在标准化后的训练集上利用基于约束的 PC 算法和基于评分的爬山算法（hill-climbing）推断环境变量之间的有向无环图（directed acyclic graph, DAG）[Ref21, Ref39]。PC 算法通过一系列条件独立性检验迭代去除边并定向箭头，爬山算法则通过在 DAG 空间中优化贝叶斯信息准则等评分函数确定最优网络结构。通过对训练数据实施约 300 次自助重采样并在每一重复中重复结构学习，计算每条有向边在重复样本中出现的频率，将边稳定性高于预设阈值的边保留用于构建共识 DAG，从而减少由采样变异引起的伪关联。

在确定环境因子的因果依赖结构后，采用双重机器学习框架估计关键候选变量对中华鲫出现概率的平均处理效应（average treatment effect, ATE）[Ref22, Ref23]。对于每个候选变量，将其标准化后相对于中位数二分为高暴露与低暴露两组，将其他环境因子视为潜在混杂变量。通过随机森林等灵活的机器学习算法分别拟合结局模型和处理模型，利用正交化残差估计在混杂控制下的 ATE，并以稳健标准误和置信区间评价统计显著性。在此基础上，采用因果森林估计条件平均处理效应（conditional average treatment effect, CATE），获得沿河流网络对关键变量变化最敏感的区域，为空间优先排序提供依据[Ref24]。

[Figure 2 placeholder: Consensus DAG of network-weighted environmental variables and distribution of bootstrap edge stabilities.]

## 2.6 未来气候情景与不确定性分解

为评估未来气候变化下的潜在分布变化，从 CMIP6 选择多种代表性路径（如 SSP1-2.6、SSP2-4.5、SSP3-7.0 和 SSP5-8.5）对应的中世纪（2041–2060 年）气候投影[Ref25]。采用下垫面一致的 Bioclim 变量（年均温、年降水、温度季节性、降水季节性）及静态地形变量（高程、坡度）作为当前与未来时期均可获得的情景一致预测因子。为避免对未来难以预测的变量（如土地利用、土壤属性）的外推风险，所有模型在仅使用这六个变量的基础上重新训练，并在独立测试集上验证其判别能力是否保持在可接受水平（AUC≥0.87）。

在生成当前与未来适宜性栅格后，分别计算不同模型间（结构不确定性）和不同情景间（情景不确定性）的像元级标准差，并通过方差分解量化二者对总预测方差的贡献[Ref28, Ref29]。同时计算跨模型的适宜性范围和一致性指数，用于识别预测共识度高的河段，从而为保护决策提供稳健的空间信息。

[Figure 3 placeholder: Schematic of modelling workflow, including network-weighted predictors, SDMs, causal analysis and future projections.]


# 3. Results

## 3.1 模型性能与整体拟合

在 336 个中华鲫存在记录与 1680 个河网背景点构成的 2016 个样本上，四种 SDM 算法在独立测试集上均表现出良好的判别能力。Maxent 模型获得最高的 AUC（约 0.909）和灵敏度（约 0.896），随机森林在 TSS（约 0.699）和特异度（约 0.789）上占优，GAM 的整体准确度（AUC 约 0.897）与树模型相当，而单隐层神经网络则在保持可接受 AUC（约 0.813）的同时，对背景样本的预测更为保守，提示其在当前设置下对高维非线性关系的捕捉尚不充分（Table 1）。Boyce 指数和 ROC 曲线均表明四模型对存在与背景样本具有显著高于随机的区分能力（[Figure 4 placeholder: ROC curves and Boyce indices for four SDMs.]）。

总体来看，多算法集成框架在独立测试集上实现了稳定且相互一致的性能，为后续因果分析和空间投影提供了稳健的概率基础。

## 3.2 关键环境驱动与因果效应

变量重要性分析显示，地形和网络加权水文气候梯度在四种算法中均为主要驱动因子。Maxent 与神经网络均将平均高程（`dem_avg`）、坡度变幅（`slope_range`）及最湿季温度（例如 `hydro_wavg_08`）列为贡献最高的变量；随机森林突出流量累积（`flow_acc`）、流径长度（`flow_length`）和最湿季降水（`hydro_wavg_18`）；GAM 的平滑项则显示平均高程对出现概率的贡献最大，其次为季节性温度指标与最湿月降水（如 `hydro_wavg_13`）。这些结果共同指向纵向高程梯度与汇水区尺度水文气候环境对中华鲫分布具有核心控制作用（[Figure 5 placeholder: Heatmap of variable importance across models.]）。

基于训练集环境数据的因果结构学习得到的共识 DAG 揭示了网络加权土地覆盖和水文气候变量在因果网络中的中心位置，高程与坡度通过调控温度和降水梯度间接作用于下游河段。利用双重机器学习估计的平均处理效应表明，城市建成区比例（`lc_wavg_09`）对适宜性具有显著正向因果效应，其 ATE 约为 0.247 且置信区间狭窄，表明在其他环境因子控制下，上游汇水区城市用地增加与中华鲫出现概率上升相关；年降水（例如 `hydro_wavg_12`）和上游黏土含量（`soil_wavg_05`）同样表现出显著正向 ATE，支持在水量充沛、细颗粒沉积物丰富的河段存在更高适宜性。高程范围与坡度变幅的正效应则印证了复杂地形中谷地和缓坡河段提供有利栖息地的假设（[Figure 6 placeholder: Forest plot of ATE estimates for key drivers.]）。

进一步基于因果森林估计的 CATE 显示，处理效应在空间上的异质性显著。大部分河段的 CATE 值围绕小幅正向效应分布，但在部分中高纬度或干旱区河段出现明显负响应尾部，表明相同的城市用地或降水增加在这些区域可能并不转化为适宜性提升，而可能因极端径流或热负荷上升而降低栖息地质量。CATE 空间图揭示了若干“高杠杆”河段，在这些位置针对关键驱动因子的管理干预预计可产生不成比例的适宜性增益，为空间优先序提供了量化依据（[Figure 7 placeholder: Map of CATE for selected drivers across the river network.]）。

## 3.3 空间适宜性格局与不确定性

在当前气候条件下，四种模型在约 186 万个河网像元上的预测均值整体偏低，中位数普遍低于 0.1，但 90 分位数可达 0.49–0.67，呈现出“低适宜背景 + 高适宜斑块”的典型格局。高适宜性河段主要分布于长江中下游干流及两湖平原、珠江三角洲以及松花江干流和相关支流，形成与历史调查中记录密集区域高度吻合的热点集群（[Figure 8 placeholder: Ensemble mean habitat suitability map under current climate.]）。在青藏高原源区和西北干旱区，大多数河段适宜性较低，仅在部分汇水区较大、局地水资源条件较好的河段出现零星高值。

模型间一致性通过像元级标准差和一致性指数进行量化。当前情景下，四模型预测的标准差平均约为 0.099，90 分位数约为 0.264，高概率河段附近的标准差相对较高，但多数低概率区域的不确定性较低。模型一致性指数的平均值约为 0.780，90 分位数接近 0.995，表明对高适宜性河段的识别在不同算法间高度一致，仅在部分环境条件极端或样本稀少的区域出现较大分歧（[Figure 9 placeholder: Spatial patterns of prediction standard deviation and model agreement.]）。

## 3.4 局地敏感度与空间异质性

局地敏感度分析表明，中华鲫对关键环境变量的响应沿纬向和流域梯度呈现显著空间异质性。南方河段对坡度变幅（如 `slope_range`）的平均敏感度最高，反映在地形复杂、坡度多变的区域，小幅地形改动即可导致适宜性明显变化；中北部河段则对季风降水和相关水文气候变量（例如 `hydro_wavg_08`）表现出更强的负响应，提示在降水集中且极端事件频发的区域，进一步增强的水文不稳定性可能削弱栖息地适宜性。耕地占比（`lc_wavg_07`）在全国范围内总体呈轻微正向敏感度，而上游黏土和砂含量在不同纬度带则多表现为负敏感度，反映沉积物负荷与底质条件对栖息地质量的约束（[Figure 10 placeholder: Local sensitivity indices for key variables across latitudinal bands.]）。

这些结果与因果分析中对土地利用和水文气候驱动因子的识别相一致，进一步支持流域尺度管理措施在调控中华鲫栖息地适宜性中的关键作用。

## 3.5 未来情景下的分布变化与不确定性分解

在仅使用六个情景一致变量（年均温、年降水、温度季节性、降水季节性、高程与坡度）重新训练并在独立测试集上保持较高 AUC（均 ≥0.87）的前提下，CMIP6 中世纪气候情景下的预测表明四种模型对中华鲫适宜性的变化趋势总体一致。在 SSP1-2.6 至 SSP5-8.5 等多种排放路径下，Maxent 的平均适宜性相较当前均下降约 25%，GAM 的平均适宜性下降约一半，而随机森林和神经网络的平均适宜性降至约 0.03–0.05，表明在大部分河段未来气候条件下适宜性将显著降低，但部分区域仍保留局地高值核心（[Figure 11 placeholder: Changes in mean suitability under multiple SSP scenarios for four models.]）。空间预测图显示，未来热点河段总体面积缩小，部分高纬度雪冰补给河段在气温上升下适宜性下降更为显著，而部分中下游河段在某些情景下仍维持相对较高的适宜性。

通过在像元尺度分解结构与情景不确定性可以看出，结构不确定性在全国范围内普遍高于情景不确定性。跨模型的预测标准差平均约为 0.10，而在固定模型下跨 SSP 的标准差仅为其一小部分，结构不确定性与情景不确定性的比值约为 4.7。这表明，在本研究系统中，模型算法和结构选择对未来适宜性预测差异的贡献远大于排放路径的不确定性（[Figure 12 placeholder: Decomposition of total prediction variance into structural and scenario components.]）。尽管如此，在约四分之三以上的河网像元中，不同模型间的一致性仍然较高，显示出对大尺度适宜性变化方向的稳健共识。综合来看，多模型、多情景的预测结果支持未来气候变暖和水文变化将导致中华鲫适宜分布范围总体收缩，并强调在制定保护与管理策略时应优先考虑结构稳健的多模型集成框架。
